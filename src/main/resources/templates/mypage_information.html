<html layout:decorate="~{layout}">

<head>

    <!-- CSS 불러오기 -->
    <link rel="stylesheet" type="text/css " href="/mypage.css">
    <!-- SweetAlert 2 스크립트 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>

<body>


<!-- 마이페이지 -->
<div class="my-wrap" layout:fragment="content">
    <div class="id-section">

        <p class="logo-text">
            <a href="/" style="width: 200px;">뭐하지 또? 또 가지 뭐! </a>
        </p>

        <h1>MY PAGE</h1>

        <!--     이미지    -->
        <div class="avatar">
            <div class="img-box">
                <img src="https://search.pstatic.net/sunny/?src=https%3A%2F%2Fi.pinimg.com%2F736x%2Ffe%2F94%2F01%2Ffe9401b82ec1a52d876b76774da990ac.jpg&type=sc960_832"
                     alt="프로필 이미지">
                <label for="profileImageInput" class="change-profile-button"><span>변경</span></label>
                <input type="file" id="profileImageInput" style="display: none;">
            </div>
        </div>

        <!--   사용자이름  -->
        <h2>한인철</h2>
        <h4 style="margin-top: 10px ">gsw05018@naver.com</h4>

        <!--    메뉴   -->
        <ul class="">
            <li><a href="#">정보 수정</a></li>
        </ul>

    </div>

    <div class="ch-section">
        <!--   정보수정 폼   -->
        <div class="join-box">
            <h2 style="text-align: center; margin-bottom: 30px; font-size: 35px;">회원 정보 수정</h2>
            <form id="userProfileForm">
                <div class="infor-box" >
                <!-- 닉네임 입력 -->
                <label for="newNickname" style="padding: 10px 20px; font-size: 20px; font-weight: 500;">새 닉네임</label>
                <input type="text" id="newNickname" name="newNickname" maxlength="50" placeholder="변경하실 닉네임을 입력해주세요"
                       style=" height: 50px; box-shadow: 0 2px 6px 0 rgba(68, 68, 68, 0.08); border: 1px solid #dadada; border-radius: 5px; padding-left: 15px;"><br>
                <span id="nicknameError" style="color: red;"></span><br>
                </div>


                <!-- 전화번호 입력 -->
                <div class="infor-box">
                <label for="newPhoneNumber" style="padding: 10px 20px; font-size: 20px; font-weight: 500;">전화번호</label>
                <input type="text" id="newPhoneNumber" name="newPhoneNumber"  placeholder="변경하실 전화번호를 입력해주세요"
                       style= " height: 50px; box-shadow: 0 2px 6px 0 rgba(68, 68, 68, 0.08); border: 1px solid #dadada; border-radius: 5px; padding-left: 15px;"><br>
                <span id="phoneError" style="color: red;"></span><br>
                </div>
                <!-- 이메일 입력 -->
                    <div class="infor-box">
                    <label for="newEmail" style="padding: 10px 20px; font-size: 20px; font-weight: 500;">이메일</label>
                <input type="email" id="newEmail" name="newEmail"  placeholder="변경하실 이메일을 입력해주세요"
                       style="  height: 50px; box-shadow: 0 2px 6px 0 rgba(68, 68, 68, 0.08); border: 1px solid #dadada; border-radius: 5px; padding-left: 15px;"><br>
                <span id="emailError" style="color: red;"></span><br>
                    </div>
                <!-- 비밀번호 입력 -->
                        <div class="infor-box">
                <label for="currentPassword" style="padding: 10px 20px; font-size: 20px; font-weight: 500;">현재 비밀번호</label>
                <input type="password" id="currentPassword" name="currentPassword"  placeholder="현재 비밀번호를 입력해주세요"
                       style=" height: 50px; box-shadow: 0 2px 6px 0 rgba(68, 68, 68, 0.08); border: 1px solid #dadada; border-radius: 5px; padding-left: 15px;"><br>
                        </div>
                            <div class="infor-box">
                <label for="newPassword" style="padding: 10px 20px; font-size: 20px; font-weight: 500;">새 비밀번호</label>
                <input type="password" id="newPassword" name="newPassword"  placeholder="변경하실 비밀번호를 입력해주세요"
                       style=" height: 50px; box-shadow: 0 2px 6px 0 rgba(68, 68, 68, 0.08); border: 1px solid #dadada; border-radius: 5px; padding-left: 15px;"><br>
                            </div>
                                <div class="infor-box">
                <label for="confirmPassword" style="padding: 10px 20px; font-size: 20px; font-weight: 500;">새 비밀번호 확인</label>
                <input type="password" id="confirmPassword" name="confirmPassword"  placeholder="변경하실 비밀번호를  다시 입력해주세요"
                       style="  height: 50px; box-shadow: 0 2px 6px 0 rgba(68, 68, 68, 0.08); border: 1px solid #dadada; border-radius: 5px; padding-left: 15px;"><br>
                <span id="passwordError" style="color: red;"></span><br>
                                </div>

                <div style="display: flex">
                    <button type="button" id="updateProfileButton"
                            style="margin-right: 20px; width: 100%; height: 50px; box-shadow: 0 2px 6px 0 rgba(68, 68, 68, 0.08); border: 1px solid #dadada; border-radius: 10px; background-color: #fff; cursor: pointer; margin-top: 30px;">
                        수정하기
                    </button>
                    <button type="button" onclick="window.location.href='/user/mypage'"
                            style="width: 100%; height: 50px; box-shadow: 0 2px 6px 0 rgba(68, 68, 68, 0.08); border: 1px solid #dadada; border-radius: 10px; background-color: #fff; cursor: pointer; margin-top: 30px;">
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // 수정하기 버튼 클릭 시
        document.getElementById("updateProfileButton").addEventListener("click", () => {
            // 입력된 정보 가져오기
            const newNickname = document.getElementById("newNickname").value;
            const newPhoneNumber = document.getElementById("newPhoneNumber").value;
            const newEmail = document.getElementById("newEmail").value;
            const currentPassword = document.getElementById("currentPassword").value;
            const newPassword = document.getElementById("newPassword").value;
            const confirmPassword = document.getElementById("confirmPassword").value;

            // 입력값 유효성 검사
            const nicknameError = document.getElementById("nicknameError");
            const phoneError = document.getElementById("phoneError");
            const emailError = document.getElementById("emailError");
            const passwordError = document.getElementById("passwordError");

            // 닉네임은 길이 제한 검사
            if (newNickname.length > 50) {
                nicknameError.textContent = "닉네임은 50자 이내여야 합니다.";
                return;
            }

            // 전화번호 형식 검사 (예시: 010-1234-5678)
            const phoneRegex = /^01[0-9]-\d{3,4}-\d{4}$/;
            if (!phoneRegex.test(newPhoneNumber)) {
                phoneError.textContent = "올바른 전화번호 형식이 아닙니다.";
                return;
            }

            // 이메일 형식 검사
            const emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
            if (!emailRegex.test(newEmail)) {
                emailError.textContent = "올바른 이메일 형식이 아닙니다.";
                return;
            }

            // 현재 비밀번호 일치 여부 검사
            if (currentPassword !== "현재비밀번호") { // 실제로는 서버에서 확인해야 함
                passwordError.textContent = "현재 비밀번호가 일치하지 않습니다.";
                return;
            }

            // 새 비밀번호와 새 비밀번호 확인 일치 여부 검사
            if (newPassword !== confirmPassword) {
                passwordError.textContent = "새 비밀번호와 새 비밀번호 확인이 일치하지 않습니다.";
                return;
            }

            // 모든 입력값이 유효한 경우 서버로 수정 요청을 보냄 (실제 서버로 보내는 부분은 구현해야 함)

            // 오류 메시지 초기화
            nicknameError.textContent = "";
            phoneError.textContent = "";
            emailError.textContent = "";
            passwordError.textContent = "";

            // SweetAlert2 등을 사용하여 수정 완료 메시지 표시
            Swal.fire({
                icon: 'success',
                title: '수정 완료',
                text: '회원 정보가 성공적으로 수정되었습니다.',
                confirmButtonText: '확인'
            });
        });
    </script>
</div>

</body>


</html>